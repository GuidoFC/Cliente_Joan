<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script src="./view/view.js"></script>
    <script src="./model/model.js"></script>
    <script src="./service/service.js"></script>
    <script>
      // Primero crearemos el tag de div con id = app
      createDiv();
      createImg();

      putImg(1);

      const alfabeto = createAllLetters();

      function createDivToWords(alfabeto) {
        // TODO necesito crear un div padre y luego muchos div para cada letra
        // contendor padre

        createContendorDiv();

        // crear los div dentro del contendor padre
        const getDivContendor = document.querySelector("#contendor");
        createAllDivForEachLetter(getDivContendor);
        styleDefault(getDivContendor);
        // to do an array with 4 words y hacer una que aparezca
        const palabraAdivinar = createWordsToGuess(getDivContendor);
        // befote to do this i want to save this word in another variable
        const savePalabraAdivinar = palabraAdivinar;

        // tranform all the words in this character "_"
        transformWordsToUnderscore(palabraAdivinar);
        //
        // select all the button with class -> classButton
        const allButtons = document.querySelectorAll(".classButton");
        console.table(allButtons);

        // disable a button
        function disableButton() {
          const anyButton = this;
          // the button can´t be clicked two times
          anyButton.disabled = true;
        }

        for (let i = 0; i < allButtons.length; i++) {
          allButtons[i].addEventListener("click", disableButton);
          // con esta función anomina evito que se ejecute inmediatamente la función!!!!!!
          // Entender que significa esto de event
          // Pasamos el evento click para poder acceder al botón clicado
          allButtons[i].addEventListener("click", (event) =>
            getTextButton(savePalabraAdivinar)
          );
        }

        // get text of the button
        function getTextButton(savePalabraAdivinar) {
          // Entender que significa esto de event
          const anyButton = event.target; // 'event.target' es el botón que fue clicado

          const getLetter = anyButton.textContent;
          const palabraCriptada = savePalabraAdivinar;

          if (thereIsThisLetter(getLetter, palabraCriptada)) {
            console.log("pintar verde");
            // cambiar el color de un solo boton
            anyButton.style.background = "rgb(111, 247, 112)";
            // desvelaremos una casilla
          } else {
            console.log("pintar rojo");
            anyButton.style.background = "rgb(205, 56, 75)";
            // cambiaremos la imagen
            changePhoto();
          }
        }
      }

      function thereIsThisLetter(getLetter, palabraCriptada) {
        const getWord = getLetter;
        for (let i = 0; i < palabraCriptada.length; i++) {
          if (palabraCriptada.charAt(i) === getLetter) {
            return true;
          }
        }
        return false;
      }

      function changePhoto() {
        // Tengo que saber el numero de la foto
        const getImg = document.querySelector("#photo");

        const getNumberActualPhoto = getNumberPhoto(getImg);

        console.log(getNumberActualPhoto);

        const incrementNumber = Number(getNumberActualPhoto) + 1;
        // incrementar ese numero para cambiar de foto
        // TODO no puedo pasar a otra foto
        debugger;
        const getSrcIMG = getImg.src;
        const pngActual = getNumberActualPhoto + ".PNG";
        const nextPng = incrementNumber + ".PNG";
        const newSrc = getSrcIMG.replace(pngActual, nextPng);
        // Asignamos el nuevo `src` a la imagen para que cambie
        getImg.src = newSrc;

        // getImg.src =
        //   "http://127.0.0.1:5500/Ex%202.%20Penjat/assests/img/" +
        //   incrementNumber +
        //   ".PNG";
      }

      function getNumberPhoto(getImg) {
        const getSrcIMG = getImg.src;

        console.log(getSrcIMG);
        const getPosition = Number(getSrcIMG.length - 5);
        const getNumber = getSrcIMG.charAt(getPosition);
        return getNumber;
      }

      createDivToWords(alfabeto);
    </script>
  </body>
</html>
